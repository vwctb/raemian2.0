<!DOCTYPE html>
<html lang="en">
    <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    <meta name="theme-color" content="#000000"><link rel="manifest" href="/manifest.json">
    <link rel="shortcut icon" href="/favicon.ico"><title>React App</title>
    <link href="/static/css/main.b6f4d77f.css" rel="stylesheet"></head>
    <body>
        <noscript>You need to enable JavaScript to run this app.</noscript>
        <div id="root"></div>
        
        <script>
            var deviceId = "0";
            var versionInfo = null, pluginPush = null , pluginCall = null;
            var swStatus = false;
            var strAgent;
            var site_name;
            var bPhoneGap = false;
            var userId;
            (function() {
                    strAgent = navigator.userAgent.toLowerCase();
                    bPhoneGap = true;
                    console.log("... is phone gap...");
            
                    var headTag = document.getElementsByTagName("head")[0];
                    var newScript = document.createElement('script');
                    newScript.type = 'text/javascript';
                    newScript.onload = function() {
                        console.log("loaded cordova javascript succeed : ");
                        loadNativeInterfacePlugin();
                    };
                    newScript.src = '/static/lib/cordova.js';
                    headTag.appendChild(newScript);
                
                    if(strAgent.match('cordova_mobile') && strAgent.match('iphone'))
                    {
                        bPhoneGap = true;
                        console.log("... is phone gap...");
                        var headTag = document.getElementsByTagName("head")[0];
                        var newScript = document.createElement('script');
                        newScript.type = 'text/javascript';
                        newScript.onload = function() {
                            //alert('loaded cordova javascript succeed');
                            console.log("loaded cordova javascript succeed : " );
                            loadNativeInterfacePlugin();
                        };
                        newScript.src = '/static/lib/cordova_ios.js';
                        headTag.appendChild(newScript);
                        return;
                    }
                    console.log("... is not phone gap...");
                    bPhoneGap = false;
                })();
                
                function loadNativeInterfacePlugin()
                {
                    var headTag = document.getElementsByTagName("head")[0];
                    var newScript = document.createElement('script');
                    newScript.type = 'text/javascript';
                    newScript.onload = function()
                    {
                        console.log("loaded cordova loadNativeInterfacePlugin : ");
                        document.addEventListener("deviceready", onDeviceReady, false);
                        document.addEventListener("resume", onResume, false);
                        document.addEventListener("pause", onPause, false);
                    };
                    newScript.src = '/static/lib/plugin_native_interface.js';
                    headTag.appendChild(newScript);
                }
                
                /// Token ID 받는 콜백 함수 정의..
                var funcGetTokenId = function onResult(_tokenId)
                {
                    console.log("onResult tokenId: " + _tokenId);
                    tokenId = _tokenId;
                };
                
                function onDeviceReady()
                {
                    console.log("onDeviceReady(): ");
                    if(typeof device === "undefined")
                    {
                        console.log('no phonegap');
                    }
                    else
                    {
                        var tempDeviceId = device.uuid;
                        deviceId = tempDeviceId.replace(/\-/g,'');
        
                        if(strAgent.match('cordova_mobile') && strAgent.match('android'))
                        {
                            pluginPush = new PushPlugin();
                            pluginPush.getToken(funcGetTokenId);
                        }else if(strAgent.match('cordova_mobile') && strAgent.match('iphone')){
                            function success(token){
                                tokenId = token;
                            }
                            function error(error){
                                //alert(error);
                            }
                            FCMPlugin.getToken(success, error);
                        }
                        loadReactApp(); 
                
                        console.log("deviceId: " + deviceId);
                        onDocumentReady();
                        var configCreate = localStorage.getItem("config_create");
                        if(configCreate != null && configCreate == 0){
                            localStorage.setItem("config_create",1);
                            onResume();
                        }
                    }
                }
                function loadReactApp(){
                    var headTag2 = document.getElementsByTagName("head")[0];
                    var newScript2 = document.createElement('script');
                    newScript2.type = 'text/javascript';
                    newScript2.onload = function() {
                        console.log("react app: ");
                        console.log('window',window);
                        alert('uuid:',window.device.uuid);
                    };
                    newScript2.src = '/static/js/main.96b46486.js';
                    headTag2.appendChild(newScript2);
                }
                function onPause()
                {
                    console.log("-----------------onPause(): ");
                    //alert('onPause');
                    localStorage.setItem("config_create",0);
                    connectGuard(guardJson_id, guardJson_dev);
                }
                
                function onResume()
                {
                    //showMessage('onResume');
                    localStorage.setItem("config_create",1);
                    console.log("-----------------onResume(): " );
                    existLockScreen(0);
                    connectGuard(guardJson_id, guardJson_dev);
                    badgeinit();
                }
        </script>



    </body>
</html>